name: Deploy Github Pages

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
        - name: Checkout
          uses: actions/checkout@v4
          with:
              fetch-depth: 0

        - name: Setup Hugo
          uses: peaceiris/actions-hugo@v3
          with:
              hugo-version: "latest"
              extended: true

        - name: Build
          run: hugo --minify

        - name: Deploy
          uses: peaceiris/actions-gh-pages@v4
          with:
              personal_token: ${{ secrets.ACCESS_TOKEN }}
              external_repository: maozedongwiki/maozedongwiki.github.io
              publish_branch: main
              publish_dir: ./public
              commit_message: auto deploy
